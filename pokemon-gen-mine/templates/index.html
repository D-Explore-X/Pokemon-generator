<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pokémon Generator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Pokémon Generator</h1>
    
    <form id="pokemon-form">
        <label for="n">Generate <select id="n" name="n">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select> Pokémon.</label>

        <label for="region">Region <select id="region" name="region">
            {% for region in options.keys() %}
                <option value="{{ region }}" {% if options.region == region %}selected{% endif %}>{{ region }}</option>
            {% endfor %}
        </select></label>

        <label for="type">Type <select id="type" name="type">
            <option value="normal">Normal</option>
            <option value="bug">Bug</option>
            <option value="dark">Dark</option>
            <option value="dragon">Dragon</option>
            <option value="electric">Electric</option>
            <option value="fairy">Fairy</option>
            <option value="fighting">Fighting</option>
            <option value="fire">Fire</option>
            <option value="flying">Flying</option>
            <option value="ghost">Ghost</option>
            <option value="grass">Grass</option>
            <option value="ground">Ground</option>
            <option value="ice">Ice</option>
            <option value="poison">Poison</option>
            <option value="psychic">Psychic</option>
            <option value="rock">Rock</option>
            <option value="steel">Steel</option>
            <option value="water">Water</option>
        </select></label>

        <label><input type="checkbox" name="legendaries">Legendaries</label>
        <label><input type="checkbox" name="nfes">NFEs</label>
        <label><input type="checkbox" name="sprites" checked>Sprites</label>
        <label><input type="checkbox" name="natures">Natures</label>
        <label><input type="checkbox" name="forms">Forms</label>

        <input type="submit" value="Generate">
    </form>

    <div id="results"></div>

    <script>
        $(document).ready(function() {
            $('#pokemon-form').submit(function(event) {
                event.preventDefault();
                $.ajax({
                    type: 'POST',
                    url: '/generate',
                    data: $('#pokemon-form').serialize(),
                    success: function(data) {
                        var resultsHtml = '';
                        data.forEach(function(pokemon) {
                            resultsHtml += '<p>' + pokemon.name;
                            if ("types" in pokemon) {
                                resultsHtml += ' - ' + pokemon.types.join(', ');
                            }
                            if ("sprites" in pokemon) {
                                resultsHtml += ' - <img src="' + pokemon.sprites.normal + '">';
                            }
                            resultsHtml += '</p>';
                        });
                        $('#results').html(resultsHtml);
                    }
                });
            });
        });
    </script>
</body>
</html>
